<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arama Sonuçları</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='search_results.css') }}">
</head>
<body>
<div class="google">
    <a href="#" id="google_logo"><h1>KOU Akademi</h1></a>
</div>

<div class="search-results">
    <h2>Aranan Kelime: </h2>
    <a id="once_button" href="/search?q={{ arama_kelimesi }}&order_by=yayin_tarihi_once">Yayımlanma Tarihi (Önce)</a>
    <a id="sonra_button" href="/search?q={{ arama_kelimesi }}&order_by=yayin_tarihi_sonra">Yayımlanma Tarihi (Sonra)</a>
    <a id="artan_button" href="/search?q={{ arama_kelimesi }}&order_by=alinti_sayisi_artan">Alıntı Sayısı (Artan)</a>
    <a id="azalan_button" href="/search?q={{ arama_kelimesi }}&order_by=alinti_sayisi_azalan">Alıntı Sayısı (Azalan)</a>


    <ul id="search-results">
        {% if results %}
            {% for result in results %}
                <li>
                    <a href="{{ result['link url'] }}">{{ result['yayin adi'] }}</a>
                    <a href="{{ result['pdf link url'] }}">{{ result['pdf link text'] }}</a>
                    <span>Alıntı Sayısı: {{ result['pdf alinti sayisi'] }}</span>
                </li>
            {% endfor %}
        {% else %}
            <p>Sonuç bulunamadı.</p>
        {% endif %}
    </ul>
</div>

<script>
    function sortBy(order) {
    var xhr = new XMLHttpRequest();

    xhr.onreadystatechange = function() {
        if (xhr.readyState == 4) {
            if (xhr.status == 200) {
                document.getElementById("search-results").innerHTML = xhr.responseText;
            } else {
                console.log("Hata: " + xhr.status);
                alert("Arama sırasında bir hata oluştu.");
            }
        }
    };

    // Sıralama parametreleri
    var orderBy = 'pdf_alinti_sayisi'; // Sıralama sütunu
    var ascending = (order === 'asc') ? 'true' : 'false'; // Artan ya da azalan sıralama

    // Arama kelimesini almak için URL'den parçalama işlemi
    var searchKeyword = window.location.pathname.split('/')[2];

    // Arama sorgusu oluşturma
    var searchQuery = "/search/" + searchKeyword + "?order_by=" + orderBy + "&ascending=" + ascending;

    xhr.open("GET", searchQuery, true);
    xhr.send();
}

</script>



</body>
</html>
